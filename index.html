<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SeguraNet ‚Äî Aprende Seguridad Social</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:ital,wght@0,300;0,400;0,500;1,300&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0d0f1a;
    --surface: #141728;
    --surface2: #1c2035;
    --border: #2a2f4a;
    --accent: #4f8ef7;
    --accent2: #f7c948;
    --accent3: #5de8b0;
    --red: #f76f6f;
    --text: #e8eaf6;
    --muted: #7a80a0;
    --radius: 16px;
  }

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'DM Sans', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* BG decoration */
  body::before {
    content: '';
    position: fixed;
    top: -200px; right: -200px;
    width: 600px; height: 600px;
    background: radial-gradient(circle, rgba(79,142,247,0.12) 0%, transparent 70%);
    pointer-events: none; z-index: 0;
  }
  body::after {
    content: '';
    position: fixed;
    bottom: -200px; left: -200px;
    width: 500px; height: 500px;
    background: radial-gradient(circle, rgba(93,232,176,0.08) 0%, transparent 70%);
    pointer-events: none; z-index: 0;
  }

  /* ===== SCREENS ===== */
  html, body { height: 100%; margin: 0; padding: 0; }

  #app {
    width: 100%;
  }

  .screen {
    display: none;
  }

  /* ===== HOME ===== */
  #home {
    min-height: 100vh;
    display: none;
    flex-direction: column;
    align-items: center; justify-content: center;
    padding: 40px 20px;
    text-align: center;
  }
  #home.active { display: flex !important; }

  .logo-badge {
    display: inline-flex; align-items: center; gap: 10px;
    background: var(--surface); border: 1px solid var(--border);
    padding: 8px 18px; border-radius: 100px;
    font-size: 13px; color: var(--accent); margin-bottom: 32px;
    letter-spacing: 0.05em; text-transform: uppercase;
    animation: fadeUp 0.6s ease both;
  }
  .logo-badge span { width: 8px; height: 8px; border-radius: 50%; background: var(--accent3); display: inline-block; animation: pulse 2s infinite; }

  h1.hero {
    font-family: 'Syne', sans-serif;
    font-size: clamp(42px, 8vw, 80px);
    font-weight: 800;
    line-height: 1.05;
    letter-spacing: -0.03em;
    margin-bottom: 20px;
    animation: fadeUp 0.7s 0.1s ease both;
  }
  h1.hero em { font-style: normal; color: var(--accent); }
  h1.hero .yellow { color: var(--accent2); }

  .hero-sub {
    font-size: 18px; color: var(--muted); font-weight: 300;
    max-width: 500px; line-height: 1.6;
    margin: 0 auto 48px;
    animation: fadeUp 0.7s 0.2s ease both;
  }

  .home-buttons {
    display: flex; gap: 16px; flex-wrap: wrap; justify-content: center;
    animation: fadeUp 0.7s 0.3s ease both;
  }

  .btn-primary {
    background: var(--accent);
    color: #fff; font-family: 'Syne', sans-serif;
    font-size: 16px; font-weight: 700;
    padding: 16px 32px; border-radius: 100px; border: none;
    cursor: pointer; transition: transform 0.15s, box-shadow 0.15s;
    box-shadow: 0 0 30px rgba(79,142,247,0.3);
  }
  .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 0 40px rgba(79,142,247,0.5); }

  .btn-secondary {
    background: transparent;
    color: var(--text); font-family: 'Syne', sans-serif;
    font-size: 16px; font-weight: 600;
    padding: 16px 32px; border-radius: 100px;
    border: 1px solid var(--border); cursor: pointer;
    transition: border-color 0.15s, background 0.15s;
  }
  .btn-secondary:hover { border-color: var(--accent); background: rgba(79,142,247,0.05); }

  .topics-preview {
    display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;
    max-width: 560px; margin: 64px auto 0;
    animation: fadeUp 0.7s 0.4s ease both;
  }
  @media(max-width: 480px) { .topics-preview { grid-template-columns: 1fr; } }

  .topic-chip {
    background: var(--surface); border: 1px solid var(--border);
    border-radius: 12px; padding: 16px 20px;
    display: flex; align-items: center; gap: 14px;
    text-align: left; cursor: pointer;
    transition: border-color 0.2s, transform 0.15s;
  }
  .topic-chip:hover { border-color: var(--accent); transform: translateY(-2px); }
  .topic-chip .icon { font-size: 28px; flex-shrink: 0; }
  .topic-chip .tc-label { font-family: 'Syne', sans-serif; font-size: 14px; font-weight: 700; }
  .topic-chip .tc-count { font-size: 12px; color: var(--muted); margin-top: 2px; }

  /* ===== MODE SELECTOR ===== */
  #mode-select {
    min-height: 100vh; display: none; flex-direction: column;
    align-items: center; justify-content: center;
    padding: 40px 20px; text-align: center;
  }
  #mode-select.active { display: flex !important; }

  .back-btn {
    position: fixed; top: 24px; left: 24px; z-index: 100;
    background: var(--surface); border: 1px solid var(--border);
    color: var(--muted); font-family: 'DM Sans', sans-serif;
    font-size: 14px; padding: 10px 18px; border-radius: 100px;
    cursor: pointer; transition: color 0.15s, border-color 0.15s;
    display: none;
  }
  .back-btn:hover { color: var(--text); border-color: var(--accent); }
  .back-btn.visible { display: block; }

  .section-title {
    font-family: 'Syne', sans-serif;
    font-size: clamp(28px, 5vw, 48px);
    font-weight: 800; margin-bottom: 10px;
    letter-spacing: -0.02em;
  }
  .section-sub { color: var(--muted); font-size: 16px; margin-bottom: 48px; }

  .mode-cards {
    display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 20px; max-width: 700px; width: 100%;
  }

  .mode-card {
    background: var(--surface); border: 1px solid var(--border);
    border-radius: var(--radius); padding: 32px 28px;
    cursor: pointer; text-align: left;
    transition: transform 0.2s, border-color 0.2s, box-shadow 0.2s;
  }
  .mode-card:hover { transform: translateY(-4px); box-shadow: 0 20px 40px rgba(0,0,0,0.3); }
  .mode-card.learn:hover { border-color: var(--accent); }
  .mode-card.quiz:hover { border-color: var(--accent2); }

  .mode-icon { font-size: 40px; margin-bottom: 18px; }
  .mode-name { font-family: 'Syne', sans-serif; font-size: 22px; font-weight: 800; margin-bottom: 8px; }
  .mode-desc { color: var(--muted); font-size: 14px; line-height: 1.6; }
  .mode-tag {
    display: inline-block; margin-top: 16px;
    font-size: 12px; font-weight: 500; padding: 4px 12px; border-radius: 100px;
  }
  .learn .mode-tag { background: rgba(79,142,247,0.15); color: var(--accent); }
  .quiz .mode-tag { background: rgba(247,201,72,0.15); color: var(--accent2); }

  /* ===== TOPIC SELECT ===== */
  #topic-select {
    min-height: 100vh; display: none; flex-direction: column;
    align-items: center; justify-content: center;
    padding: 80px 20px 40px;
  }
  #topic-select.active { display: flex !important; }

  .topic-grid {
    display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: 16px; max-width: 800px; width: 100%; margin-top: 40px;
  }

  .topic-card {
    background: var(--surface); border: 2px solid var(--border);
    border-radius: var(--radius); padding: 28px 24px;
    cursor: pointer; transition: all 0.2s;
    position: relative; overflow: hidden;
  }
  .topic-card::before {
    content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px;
    background: var(--accent-color, var(--accent)); opacity: 0; transition: opacity 0.2s;
  }
  .topic-card:hover::before { opacity: 1; }
  .topic-card:hover { transform: translateY(-3px); border-color: var(--accent-color, var(--accent)); }

  .topic-card[data-color="blue"] { --accent-color: var(--accent); }
  .topic-card[data-color="green"] { --accent-color: var(--accent3); }
  .topic-card[data-color="yellow"] { --accent-color: var(--accent2); }
  .topic-card[data-color="red"] { --accent-color: var(--red); }

  .tc-icon { font-size: 36px; margin-bottom: 14px; }
  .tc-name { font-family: 'Syne', sans-serif; font-size: 18px; font-weight: 700; margin-bottom: 6px; }
  .tc-desc { font-size: 13px; color: var(--muted); line-height: 1.5; }
  .tc-pills { display: flex; flex-wrap: wrap; gap: 6px; margin-top: 14px; }
  .tc-pill { font-size: 11px; padding: 3px 10px; border-radius: 100px; background: var(--surface2); color: var(--muted); }

  /* ===== LESSON SCREEN ===== */
  #lesson-screen { display: none; padding: 100px 20px 60px; max-width: 760px; margin: 0 auto; }
  #lesson-screen.active { display: block; }

  .lesson-progress {
    position: fixed; top: 0; left: 0; right: 0; z-index: 50;
    background: var(--bg); border-bottom: 1px solid var(--border);
    padding: 16px 24px 16px 100px;
    display: flex; align-items: center; gap: 16px;
  }
  .progress-bar-wrap {
    flex: 1; height: 6px; background: var(--surface2);
    border-radius: 100px; overflow: hidden;
  }
  .progress-bar-fill {
    height: 100%; background: var(--accent);
    border-radius: 100px; transition: width 0.4s ease;
  }
  .progress-label { font-size: 13px; color: var(--muted); white-space: nowrap; }

  .lesson-card {
    background: var(--surface); border: 1px solid var(--border);
    border-radius: 20px; padding: 40px;
    animation: fadeUp 0.4s ease both;
  }

  .lesson-tag {
    display: inline-flex; align-items: center; gap: 8px;
    font-size: 12px; text-transform: uppercase; letter-spacing: 0.08em;
    color: var(--accent); margin-bottom: 20px;
  }
  .lesson-tag .dot { width: 6px; height: 6px; background: var(--accent); border-radius: 50%; }

  .lesson-title {
    font-family: 'Syne', sans-serif; font-size: clamp(22px, 4vw, 32px);
    font-weight: 800; margin-bottom: 20px; line-height: 1.2;
  }

  .lesson-body { font-size: 16px; line-height: 1.8; color: #c8cce8; }
  .lesson-body p { margin-bottom: 16px; }
  .lesson-body strong { color: var(--text); font-weight: 500; }

  .info-box {
    background: var(--surface2); border-left: 3px solid var(--accent);
    border-radius: 0 12px 12px 0; padding: 16px 20px;
    margin: 20px 0; font-size: 14px; line-height: 1.7;
  }
  .info-box.yellow { border-color: var(--accent2); }
  .info-box.green { border-color: var(--accent3); }

  .lesson-nav {
    display: flex; justify-content: space-between; align-items: center;
    margin-top: 32px; gap: 12px;
  }

  .btn-nav {
    background: var(--surface2); border: 1px solid var(--border);
    color: var(--text); font-family: 'Syne', sans-serif;
    font-size: 15px; font-weight: 600;
    padding: 14px 28px; border-radius: 100px; cursor: pointer;
    transition: all 0.15s;
  }
  .btn-nav:hover { border-color: var(--accent); background: rgba(79,142,247,0.08); }
  .btn-nav:disabled { opacity: 0.3; cursor: not-allowed; }
  .btn-nav.next { background: var(--accent); border-color: var(--accent); color: #fff; }
  .btn-nav.next:hover { box-shadow: 0 0 30px rgba(79,142,247,0.4); }

  /* ===== QUIZ SCREEN ===== */
  #quiz-screen { display: none; padding: 100px 20px 60px; max-width: 680px; margin: 0 auto; }
  #quiz-screen.active { display: block; }

  .quiz-card {
    background: var(--surface); border: 1px solid var(--border);
    border-radius: 20px; padding: 40px;
    animation: fadeUp 0.4s ease both;
  }

  .quiz-meta {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 28px;
  }
  .quiz-number { font-size: 13px; color: var(--muted); }
  .quiz-score-badge {
    font-family: 'Syne', sans-serif; font-size: 14px; font-weight: 700;
    padding: 6px 14px; border-radius: 100px;
    background: rgba(93,232,176,0.1); color: var(--accent3);
  }

  .quiz-question {
    font-family: 'Syne', sans-serif; font-size: clamp(18px, 3vw, 24px);
    font-weight: 700; line-height: 1.35; margin-bottom: 32px;
  }

  .options { display: flex; flex-direction: column; gap: 12px; }

  .option-btn {
    background: var(--surface2); border: 2px solid var(--border);
    color: var(--text); font-family: 'DM Sans', sans-serif;
    font-size: 15px; font-weight: 400;
    padding: 16px 20px; border-radius: 12px;
    cursor: pointer; text-align: left; transition: all 0.15s;
    display: flex; align-items: center; gap: 14px;
  }
  .option-btn .opt-letter {
    width: 28px; height: 28px; border-radius: 50%;
    background: var(--surface); border: 1px solid var(--border);
    display: flex; align-items: center; justify-content: center;
    font-family: 'Syne', sans-serif; font-size: 12px; font-weight: 700;
    flex-shrink: 0; transition: all 0.15s;
  }
  .option-btn:hover:not(:disabled) { border-color: var(--accent); background: rgba(79,142,247,0.06); }
  .option-btn:hover:not(:disabled) .opt-letter { background: var(--accent); border-color: var(--accent); color: #fff; }
  .option-btn.correct { border-color: var(--accent3) !important; background: rgba(93,232,176,0.08) !important; }
  .option-btn.correct .opt-letter { background: var(--accent3) !important; border-color: var(--accent3) !important; color: #000 !important; }
  .option-btn.wrong { border-color: var(--red) !important; background: rgba(247,111,111,0.08) !important; }
  .option-btn.wrong .opt-letter { background: var(--red) !important; border-color: var(--red) !important; color: #fff !important; }
  .option-btn:disabled { cursor: not-allowed; }

  .feedback-box {
    margin-top: 20px; padding: 16px 20px;
    border-radius: 12px; font-size: 14px; line-height: 1.6;
    display: none;
  }
  .feedback-box.correct { background: rgba(93,232,176,0.1); border: 1px solid rgba(93,232,176,0.3); color: var(--accent3); }
  .feedback-box.wrong { background: rgba(247,111,111,0.1); border: 1px solid rgba(247,111,111,0.3); color: var(--red); }
  .feedback-box .feedback-icon { font-size: 18px; margin-right: 8px; }

  .quiz-next {
    margin-top: 24px; width: 100%;
    background: var(--accent); border: none; border-radius: 100px;
    color: #fff; font-family: 'Syne', sans-serif;
    font-size: 16px; font-weight: 700;
    padding: 16px; cursor: pointer; display: none;
    transition: box-shadow 0.15s, transform 0.15s;
  }
  .quiz-next:hover { box-shadow: 0 0 30px rgba(79,142,247,0.4); transform: translateY(-1px); }

  /* ===== RESULTS SCREEN ===== */
  #results-screen {
    min-height: 100vh; display: none; flex-direction: column;
    align-items: center; justify-content: center;
    padding: 80px 20px; text-align: center;
  }
  #results-screen.active { display: flex !important; }

  .score-ring {
    width: 160px; height: 160px; margin: 0 auto 32px;
    position: relative;
  }
  .score-ring svg { width: 100%; height: 100%; transform: rotate(-90deg); }
  .score-ring circle { fill: none; stroke-width: 10; stroke-linecap: round; }
  .score-ring .bg-ring { stroke: var(--surface2); }
  .score-ring .fg-ring { stroke: var(--accent3); stroke-dasharray: 408; transition: stroke-dashoffset 1s ease; }
  .score-center {
    position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%);
    font-family: 'Syne', sans-serif; font-size: 36px; font-weight: 800;
  }

  .result-title { font-family: 'Syne', sans-serif; font-size: 36px; font-weight: 800; margin-bottom: 10px; }
  .result-sub { color: var(--muted); font-size: 16px; margin-bottom: 40px; }

  .result-actions { display: flex; gap: 14px; flex-wrap: wrap; justify-content: center; }

  /* ===== ANIMATIONS ===== */
  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }
  @keyframes pulse {
    0%, 100% { opacity: 1; } 50% { opacity: 0.4; }
  }

  /* ===== RESPONSIVE ===== */
  @media(max-width: 600px) {
    .lesson-card, .quiz-card { padding: 24px 20px; }
    .lesson-nav { flex-direction: column; }
    .btn-nav { width: 100%; text-align: center; }
    .lesson-progress { padding-left: 80px; }
  }
</style>
</head>
<body>

<div id="app">
<!-- BACK BUTTON -->
<button class="back-btn" id="backBtn" onclick="goBack()">‚Üê Volver</button>

<!-- ===== HOME ===== -->
<div id="home" class="screen active">
  <div class="logo-badge"><span></span> IPE I ¬∑ Seguridad Social</div>
  <h1 class="hero">Aprende<br><em>Seguridad</em><br><span class="yellow">Social</span></h1>
  <p class="hero-sub">4 unidades tem√°ticas, lecciones interactivas y quizzes para consolidar lo aprendido.</p>
  <div class="home-buttons">
    <button class="btn-primary" onclick="showScreen('mode-select')">Empezar ahora</button>
  </div>
  <div class="topics-preview">
    <div class="topic-chip" onclick="startLearnTopic(0)">
      <span class="icon">üèõÔ∏è</span>
      <div><div class="tc-label">Reg√≠menes y Afiliaci√≥n</div><div class="tc-count">3 lecciones ¬∑ 6 preguntas</div></div>
    </div>
    <div class="topic-chip" onclick="startLearnTopic(1)">
      <span class="icon">üí∂</span>
      <div><div class="tc-label">Cotizaciones y Bases</div><div class="tc-count">3 lecciones ¬∑ 6 preguntas</div></div>
    </div>
    <div class="topic-chip" onclick="startLearnTopic(2)">
      <span class="icon">ü©∫</span>
      <div><div class="tc-label">Prestaciones</div><div class="tc-count">3 lecciones ¬∑ 6 preguntas</div></div>
    </div>
    <div class="topic-chip" onclick="startLearnTopic(3)">
      <span class="icon">‚öñÔ∏è</span>
      <div><div class="tc-label">Derechos y Obligaciones</div><div class="tc-count">3 lecciones ¬∑ 6 preguntas</div></div>
    </div>
  </div>
</div>

<!-- ===== MODE SELECT ===== -->
<div id="mode-select" class="screen">
  <h2 class="section-title">¬øC√≥mo quieres<br>aprender hoy?</h2>
  <p class="section-sub">Elige tu modo de estudio</p>
  <div class="mode-cards">
    <div class="mode-card learn" onclick="showScreen('topic-select'); setMode('learn')">
      <div class="mode-icon">üìñ</div>
      <div class="mode-name">Lecci√≥n + Quiz</div>
      <p class="mode-desc">Aprende el contenido paso a paso y consolida con preguntas al final de cada bloque.</p>
      <span class="mode-tag">Recomendado</span>
    </div>
    <div class="mode-card quiz" onclick="showScreen('topic-select'); setMode('quiz')">
      <div class="mode-icon">‚ö°</div>
      <div class="mode-name">Solo Quiz</div>
      <p class="mode-desc">Pon a prueba lo que ya sabes directamente con preguntas tipo test.</p>
      <span class="mode-tag">Repaso r√°pido</span>
    </div>
  </div>
</div>

<!-- ===== TOPIC SELECT ===== -->
<div id="topic-select" class="screen">
  <h2 class="section-title" style="text-align:center">Elige un tema</h2>
  <p class="section-sub" style="text-align:center">Selecciona el bloque que quieres estudiar</p>
  <div class="topic-grid">
    <div class="topic-card" data-color="blue" onclick="selectTopic(0)">
      <div class="tc-icon">üèõÔ∏è</div>
      <div class="tc-name">Reg√≠menes y Afiliaci√≥n</div>
      <p class="tc-desc">C√≥mo funciona la estructura del sistema y qui√©n pertenece a cada r√©gimen.</p>
      <div class="tc-pills"><span class="tc-pill">R√©gimen General</span><span class="tc-pill">Aut√≥nomos (RETA)</span><span class="tc-pill">Alta/Baja</span></div>
    </div>
    <div class="topic-card" data-color="yellow" onclick="selectTopic(1)">
      <div class="tc-icon">üí∂</div>
      <div class="tc-name">Cotizaciones y Bases</div>
      <p class="tc-desc">C√≥mo se calculan las cuotas, qui√©n las paga y para qu√© sirven.</p>
      <div class="tc-pills"><span class="tc-pill">Base de cotizaci√≥n</span><span class="tc-pill">Tipos</span><span class="tc-pill">Empresa vs trabajador</span></div>
    </div>
    <div class="topic-card" data-color="green" onclick="selectTopic(2)">
      <div class="tc-icon">ü©∫</div>
      <div class="tc-name">Prestaciones</div>
      <p class="tc-desc">Qu√© cobro y cu√°ndo: desempleo, incapacidad, jubilaci√≥n y m√°s.</p>
      <div class="tc-pills"><span class="tc-pill">Paro</span><span class="tc-pill">IT</span><span class="tc-pill">Jubilaci√≥n</span><span class="tc-pill">Maternidad</span></div>
    </div>
    <div class="topic-card" data-color="red" onclick="selectTopic(3)">
      <div class="tc-icon">‚öñÔ∏è</div>
      <div class="tc-name">Derechos y Obligaciones</div>
      <p class="tc-desc">Lo que la ley garantiza y lo que exige a empresas y trabajadores.</p>
      <div class="tc-pills"><span class="tc-pill">Obligaciones empresa</span><span class="tc-pill">Infracciones</span><span class="tc-pill">Derechos</span></div>
    </div>
  </div>
</div>

<!-- ===== LESSON SCREEN ===== -->
<div id="lesson-screen" class="screen">
  <div class="lesson-progress">
    <div class="progress-bar-wrap"><div class="progress-bar-fill" id="lessonProgressBar"></div></div>
    <span class="progress-label" id="lessonProgressLabel"></span>
  </div>
  <div class="lesson-card" id="lessonCard"></div>
</div>

<!-- ===== QUIZ SCREEN ===== -->
<div id="quiz-screen" class="screen">
  <div class="lesson-progress">
    <div class="progress-bar-wrap"><div class="progress-bar-fill" id="quizProgressBar" style="background: var(--accent2)"></div></div>
    <span class="progress-label" id="quizProgressLabel"></span>
  </div>
  <div class="quiz-card">
    <div class="quiz-meta">
      <span class="quiz-number" id="quizNumber"></span>
      <span class="quiz-score-badge" id="quizScoreBadge">‚úì 0 correctas</span>
    </div>
    <div class="quiz-question" id="quizQuestion"></div>
    <div class="options" id="quizOptions"></div>
    <div class="feedback-box" id="feedbackBox"></div>
    <button class="quiz-next" id="quizNext" onclick="nextQuestion()">Siguiente pregunta ‚Üí</button>
  </div>
</div>

<!-- ===== RESULTS SCREEN ===== -->
<div id="results-screen" class="screen">
  <div class="score-ring">
    <svg viewBox="0 0 140 140">
      <circle class="bg-ring" cx="70" cy="70" r="65"/>
      <circle class="fg-ring" id="resultRing" cx="70" cy="70" r="65"/>
    </svg>
    <div class="score-center" id="resultScore"></div>
  </div>
  <h2 class="result-title" id="resultTitle"></h2>
  <p class="result-sub" id="resultSub"></p>
  <div class="result-actions">
    <button class="btn-primary" onclick="repeatQuiz()">Repetir quiz</button>
    <button class="btn-secondary" onclick="showScreen('topic-select')">Otro tema</button>
    <button class="btn-secondary" onclick="showScreen('home')">Inicio</button>
  </div>
</div>

</div><!-- /#app -->

<script>
// =====================
// DATA
// =====================
const topics = [
  {
    id: 0, name: "Reg√≠menes y Afiliaci√≥n",
    lessons: [
      {
        tag: "Lecci√≥n 1 ‚Äî Reg√≠menes",
        title: "¬øQu√© son los reg√≠menes de la Seguridad Social?",
        body: `
          <p>La Seguridad Social espa√±ola no es un sistema √∫nico para todos: est√° organizada en <strong>reg√≠menes</strong>, es decir, diferentes ¬´categor√≠as¬ª seg√∫n el tipo de trabajo que realizas.</p>
          <p>El m√°s importante es el <strong>R√©gimen General</strong>, que incluye a la mayor√≠a de trabajadores por cuenta ajena: empleados de empresas privadas, funcionarios no adscritos a mutualidades propias, etc.</p>
          <div class="info-box">üí° <strong>Dato clave:</strong> El R√©gimen General afecta a m√°s del 85% de los trabajadores afiliados en Espa√±a.</div>
          <p>Junto a √©l existen <strong>reg√≠menes especiales</strong> para colectivos con caracter√≠sticas propias: aut√≥nomos (RETA), empleados del hogar, trabajadores del mar, miner√≠a del carb√≥n y los estudiantes en pr√°cticas.</p>
        `
      },
      {
        tag: "Lecci√≥n 2 ‚Äî Afiliaci√≥n",
        title: "Darse de alta: la afiliaci√≥n",
        body: `
          <p>Antes de empezar a trabajar, todo trabajador debe estar <strong>afiliado</strong> a la Seguridad Social y en <strong>situaci√≥n de alta</strong>. Son dos conceptos distintos:</p>
          <div class="info-box green">‚úÖ <strong>Afiliaci√≥n:</strong> es un acto √∫nico en la vida. Se realiza la primera vez que trabajas y te asigna un <strong>n√∫mero de afiliaci√≥n (NAF)</strong> permanente.</div>
          <div class="info-box">üîÑ <strong>Alta:</strong> se produce cada vez que inicias una relaci√≥n laboral. Puede haber m√∫ltiples altas y bajas a lo largo de tu vida laboral.</div>
          <p>Normalmente es <strong>la empresa</strong> quien tramita tanto la afiliaci√≥n como el alta del trabajador, antes o el mismo d√≠a de inicio del trabajo. El incumplimiento tiene sanciones graves.</p>
        `
      },
      {
        tag: "Lecci√≥n 3 ‚Äî El RETA",
        title: "Los aut√≥nomos: el R√©gimen Especial",
        body: `
          <p>Los trabajadores por cuenta propia est√°n encuadrados en el <strong>RETA (R√©gimen Especial de Trabajadores Aut√≥nomos)</strong>. A diferencia de los asalariados, ellos mismos gestionan y pagan su cotizaci√≥n.</p>
          <p>Desde 2023 existe el <strong>sistema de cotizaci√≥n por ingresos reales</strong>: el aut√≥nomo declara sus rendimientos netos estimados y cotiza en funci√≥n de tramos de ingresos, pudiendo ajustar la cuota cada dos meses.</p>
          <div class="info-box yellow">‚ö†Ô∏è <strong>Recuerda:</strong> Un aut√≥nomo que no cotiza pierde el derecho a prestaciones como la incapacidad temporal o la jubilaci√≥n. En 2026 se mantienen las tablas de cotizaci√≥n de 2025: la cuota m√≠nima es de aproximadamente <strong>200‚Ç¨/mes</strong> (tramo de rendimientos m√°s bajos).</div>
        `
      }
    ],
    quiz: [
      {
        q: "¬øCu√°l es el r√©gimen que engloba a la mayor√≠a de trabajadores asalariados en Espa√±a?",
        opts: ["R√©gimen Especial del Mar", "R√©gimen General", "RETA", "R√©gimen de Empleados del Hogar"],
        correct: 1,
        explain: "El R√©gimen General es el pilar central del sistema y agrupa a m√°s del 85% de los afiliados: trabajadores por cuenta ajena de empresas privadas y determinados empleados p√∫blicos."
      },
      {
        q: "¬øQu√© es el n√∫mero de afiliaci√≥n (NAF)?",
        opts: ["Un c√≥digo que cambia cada vez que cambias de empresa", "Un n√∫mero que se obtiene solo si eres aut√≥nomo", "Un identificador √∫nico y permanente que se asigna la primera vez que trabajas", "El n√∫mero de tu contrato laboral"],
        correct: 2,
        explain: "El NAF se asigna una sola vez en la vida, la primera vez que te afilias a la Seguridad Social. Permanece invariable aunque cambies de trabajo, r√©gimen o tengas periodos sin cotizar."
      },
      {
        q: "¬øQui√©n es el responsable habitual de dar de alta a un trabajador por cuenta ajena en la Seguridad Social?",
        opts: ["El propio trabajador", "El Ministerio de Trabajo", "La empresa empleadora", "La Inspecci√≥n de Trabajo"],
        correct: 2,
        explain: "En el R√©gimen General, la empresa es quien tiene la obligaci√≥n de tramitar el alta del trabajador antes o el mismo d√≠a en que inicia su actividad. No hacerlo constituye una infracci√≥n grave."
      },
      {
        q: "¬øQu√© novedad introdujo el sistema de cotizaci√≥n del RETA desde 2023?",
        opts: ["Los aut√≥nomos dejaron de cotizar", "La cuota es fija para todos en 400‚Ç¨/mes", "Se cotiza en funci√≥n de los ingresos reales declarados", "Los aut√≥nomos pasan al R√©gimen General"],
        correct: 2,
        explain: "Desde enero de 2023, los aut√≥nomos cotizan seg√∫n sus rendimientos netos reales, distribuidos en 15 tramos. Pueden modificar su base de cotizaci√≥n hasta 6 veces al a√±o."
      },
      {
        q: "¬øCu√°ntas veces puede una persona afiliarse a la Seguridad Social a lo largo de su vida?",
        opts: ["Tantas veces como empleos tenga", "Una sola vez", "Una vez por cada r√©gimen diferente", "Dos veces como m√°ximo"],
        correct: 1,
        explain: "La afiliaci√≥n es un acto √∫nico y vitalicio. Una vez afiliado, el NAF te acompa√±a para siempre. Lo que se repite en cada nuevo empleo es el alta, no la afiliaci√≥n."
      },
      {
        q: "¬øCu√°l de estos colectivos NO pertenece al R√©gimen General?",
        opts: ["Empleado de una empresa privada", "Funcionario de administraci√≥n local", "Trabajador aut√≥nomo freelance", "Trabajador contratado a tiempo parcial"],
        correct: 2,
        explain: "Los trabajadores aut√≥nomos est√°n encuadrados en el RETA (R√©gimen Especial de Trabajadores Aut√≥nomos), no en el R√©gimen General. El resto de opciones s√≠ pertenecen habitualmente al R√©gimen General."
      }
    ]
  },
  {
    id: 1, name: "Cotizaciones y Bases",
    lessons: [
      {
        tag: "Lecci√≥n 1 ‚Äî Qu√© es cotizar",
        title: "¬øPara qu√© sirve cotizar?",
        body: `
          <p>Cotizar a la Seguridad Social es <strong>contribuir econ√≥micamente</strong> al sistema para tener derecho a sus prestaciones en el futuro: la jubilaci√≥n, el paro, la baja por enfermedad, etc.</p>
          <p>La cotizaci√≥n funciona como un <strong>seguro colectivo</strong>: todos aportamos seg√∫n nuestros ingresos y el sistema nos protege cuando lo necesitamos.</p>
          <div class="info-box">üí° No cotizar o hacerlo por debajo de lo real es ilegal y puede dejarte sin derechos a prestaciones o con una pensi√≥n reducida.</div>
          <p>El periodo cotizado tambi√©n determina el <strong>¬´periodo de carencia¬ª</strong>: el m√≠nimo de tiempo cotizado que se exige para acceder a cada prestaci√≥n.</p>
        `
      },
      {
        tag: "Lecci√≥n 2 ‚Äî La base de cotizaci√≥n",
        title: "Base de cotizaci√≥n: ¬øsobre qu√© se calcula?",
        body: `
          <p>La <strong>base de cotizaci√≥n</strong> es el importe sobre el que se aplican los porcentajes para calcular cu√°nto hay que pagar. En el R√©gimen General se calcula a partir del <strong>salario bruto mensual</strong> m√°s las pagas extraordinarias prorrateadas.</p>
          <p>Tiene un <strong>m√≠nimo y un m√°ximo</strong> establecidos cada a√±o por ley. En 2024:</p>
          <div class="info-box green">üìä Base m√≠nima: <strong>pendiente de actualizaci√≥n con el SMI 2026</strong> (se aplican provisionalmente las bases de 2025)<br>Base m√°xima: <strong>5.101,20‚Ç¨/mes</strong> (RDL 3/2026)</div>
          <p>Si tu salario est√° entre estos l√≠mites, cotizas por tu salario real. Si supera el m√°ximo, solo cotizas hasta ese tope.</p>
        `
      },
      {
        tag: "Lecci√≥n 3 ‚Äî Tipos y reparto",
        title: "¬øCu√°nto paga cada uno?",
        body: `
          <p>A la base de cotizaci√≥n se aplican <strong>tipos de cotizaci√≥n</strong> (porcentajes). Existen tipos para contingencias comunes, desempleo, FOGASA y formaci√≥n profesional.</p>
          <p>La cuota se reparte entre <strong>empresa y trabajador</strong>, pero la proporci√≥n es muy desigual:</p>
          <div class="info-box yellow">
            üè¢ <strong>Empresa:</strong> ~23,6% (contingencias comunes) + otros conceptos ‚Üí total aprox. <strong>30%</strong><br>
            üë§ <strong>Trabajador:</strong> 4,7% (contingencias comunes) + 1,55% (desempleo) + 0,1% (FP) ‚Üí total aprox. <strong>6,35%</strong>
          </div>
          <p>Por eso aunque el trabajador ¬´descuenta¬ª de su n√≥mina, la empresa paga mucho m√°s al sistema por cada empleado.</p>
        `
      }
    ],
    quiz: [
      {
        q: "¬øQu√© es la base de cotizaci√≥n?",
        opts: ["El salario neto que cobra el trabajador", "El importe sobre el que se aplican los tipos para calcular la cuota", "La cantidad m√°xima que puede cobrar un trabajador", "El n√∫mero de horas trabajadas al mes"],
        correct: 1,
        explain: "La base de cotizaci√≥n es el importe de referencia (ligado al salario bruto) sobre el que se aplican los porcentajes o tipos de cotizaci√≥n para obtener la cuota mensual a ingresar."
      },
      {
        q: "¬øQu√© ocurre si el salario de un trabajador supera la base m√°xima de cotizaci√≥n?",
        opts: ["Cotiza por su salario completo", "Est√° exento de cotizar", "Solo cotiza hasta la base m√°xima establecida", "Cambia de r√©gimen autom√°ticamente"],
        correct: 2,
        explain: "Existe un tope m√°ximo de cotizaci√≥n. Si el salario supera ese techo, la cotizaci√≥n se calcula solo hasta la base m√°xima, independientemente de lo que se gane por encima."
      },
      {
        q: "¬øQui√©n aporta una mayor proporci√≥n a la Seguridad Social por cada empleado?",
        opts: ["El trabajador", "La empresa y el trabajador a partes iguales", "La empresa", "El Estado"],
        correct: 2,
        explain: "La empresa aporta aproximadamente el 30% de la base de cotizaci√≥n, mientras que el trabajador solo aporta alrededor del 6,35%. La carga principal recae sobre el empleador."
      },
      {
        q: "¬øA qu√© se denomina ¬´periodo de carencia¬ª?",
        opts: ["El tiempo que tarda Hacienda en devolver el IRPF", "El tiempo m√≠nimo cotizado exigido para acceder a una prestaci√≥n", "El periodo en que no se puede cobrar el paro", "La antig√ºedad m√≠nima en una empresa para no ser despedido"],
        correct: 1,
        explain: "El periodo de carencia es el tiempo m√≠nimo que hay que haber cotizado para tener derecho a una prestaci√≥n concreta. Por ejemplo, para acceder a la prestaci√≥n por desempleo se necesitan al menos 360 d√≠as cotizados en los √∫ltimos 6 a√±os."
      },
      {
        q: "La base de cotizaci√≥n en el R√©gimen General se calcula principalmente a partir de‚Ä¶",
        opts: ["El salario neto mensual", "El salario bruto mensual incluyendo pagas extra prorrateadas", "Solo las pagas extraordinarias", "El Indicador P√∫blico de Renta de Efectos M√∫ltiples (IPREM)"],
        correct: 1,
        explain: "La base de cotizaci√≥n incluye el salario bruto mensual m√°s la parte proporcional de las pagas extraordinarias, las horas extra y otros conceptos retributivos regulares."
      },
      {
        q: "¬øCu√°l es la base m√°xima de cotizaci√≥n al R√©gimen General en 2026?",
        opts: ["3.500‚Ç¨/mes", "4.720,50‚Ç¨/mes", "5.101,20‚Ç¨/mes", "6.000‚Ç¨/mes"],
        correct: 2,
        explain: "Seg√∫n el RDL 3/2026, la base m√°xima de cotizaci√≥n al R√©gimen General queda fijada en 5.101,20‚Ç¨ mensuales desde el 1 de enero de 2026, un 3,9% m√°s que en 2025."
      }
    ]
  },
  {
    id: 2, name: "Prestaciones",
    lessons: [
      {
        tag: "Lecci√≥n 1 ‚Äî Incapacidad Temporal",
        title: "La baja por enfermedad (IT)",
        body: `
          <p>La <strong>Incapacidad Temporal (IT)</strong> es la prestaci√≥n que cubre los periodos en los que no puedes trabajar por enfermedad o accidente.</p>
          <p>Existen dos tipos principales:</p>
          <div class="info-box green">ü§ß <strong>Enfermedad com√∫n o accidente no laboral:</strong> se exigen 180 d√≠as cotizados en los √∫ltimos 5 a√±os. La prestaci√≥n empieza a pagarse desde el <strong>4.¬∫ d√≠a</strong> de baja.</div>
          <div class="info-box">ü¶∫ <strong>Accidente de trabajo o enfermedad profesional:</strong> no hay periodo de carencia. La prestaci√≥n se percibe desde el d√≠a siguiente al accidente.</div>
          <p>El <strong>importe</strong> var√≠a: entre el 60% y el 75% de la base reguladora, seg√∫n los d√≠as de baja y el tipo de contingencia.</p>
        `
      },
      {
        tag: "Lecci√≥n 2 ‚Äî Desempleo",
        title: "El paro: c√≥mo funciona",
        body: `
          <p>La <strong>prestaci√≥n contributiva por desempleo</strong> (el ¬´paro¬ª) es la ayuda econ√≥mica que se percibe al quedarse sin trabajo de forma involuntaria.</p>
          <p>Para tener derecho necesitas:</p>
          <div class="info-box yellow">üìã Haber cotizado al menos <strong>360 d√≠as</strong> en los √∫ltimos 6 a√±os<br>Que la extinci√≥n del contrato sea <strong>involuntaria</strong> (despido, ERE, fin de contrato temporal‚Ä¶)<br>Estar en situaci√≥n legal de desempleo e inscrito como demandante de empleo</div>
          <p>La duraci√≥n var√≠a entre <strong>4 meses</strong> (360 d√≠as cotizados) y <strong>24 meses</strong> (6 a√±os o m√°s cotizados). El importe es el 70% de la base reguladora los primeros 6 meses, y el 60% a partir del 7.¬∫ mes.</p>
        `
      },
      {
        tag: "Lecci√≥n 3 ‚Äî Jubilaci√≥n y otras",
        title: "Jubilaci√≥n, maternidad y paternidad",
        body: `
          <p>La <strong>pensi√≥n de jubilaci√≥n</strong> es la prestaci√≥n m√°s importante del sistema. En 2026 existen dos v√≠as de jubilaci√≥n ordinaria: con <strong>65 a√±os</strong> si se acreditan al menos <strong>38 a√±os y 3 meses cotizados</strong>, o con <strong>66 a√±os y 10 meses</strong> para quienes tengan menos tiempo cotizado (en 2027 la edad general subir√° a 67 a√±os).</p>
          <div class="info-box">üìà Para cobrar el <strong>100% de la base reguladora</strong> en 2026 se necesitan <strong>36 a√±os y 6 meses cotizados</strong>. Con solo 15 a√±os cotizados se accede al 50%. A partir de 2027 subir√° a 37 a√±os.</div>
          <p>El <strong>nacimiento y cuidado del menor</strong> da derecho a <strong>16 semanas</strong> de permiso remunerado tanto para la madre como para el padre (intransferibles). La prestaci√≥n es el <strong>100% de la base reguladora</strong>, sin periodo de carencia para nacimiento biol√≥gico.</p>
          <p>Existen tambi√©n prestaciones por <strong>riesgo durante el embarazo</strong>, <strong>incapacidad permanente</strong>, <strong>viudedad</strong>, <strong>orfandad</strong> y el <strong>Ingreso M√≠nimo Vital (IMV)</strong>.</p>
        `
      }
    ],
    quiz: [
      {
        q: "¬øDesde qu√© d√≠a cobra el trabajador la prestaci√≥n por Incapacidad Temporal derivada de enfermedad com√∫n?",
        opts: ["Desde el primer d√≠a de baja", "Desde el segundo d√≠a de baja", "Desde el cuarto d√≠a de baja", "Desde el decimoquinto d√≠a de baja"],
        correct: 2,
        explain: "En la IT por enfermedad com√∫n o accidente no laboral, los primeros 3 d√≠as de baja (d√≠as 1, 2 y 3) no se cobran. La prestaci√≥n empieza a devengarse a partir del 4.¬∫ d√≠a."
      },
      {
        q: "¬øCu√°ntos d√≠as cotizados son necesarios como m√≠nimo para cobrar la prestaci√≥n por desempleo?",
        opts: ["180 d√≠as", "360 d√≠as", "720 d√≠as", "1.800 d√≠as"],
        correct: 1,
        explain: "Se necesitan al menos 360 d√≠as cotizados en los √∫ltimos 6 a√±os para tener derecho a la prestaci√≥n contributiva por desempleo, lo que da derecho a 4 meses de paro."
      },
      {
        q: "¬øCu√°l es la edad de jubilaci√≥n ordinaria en 2026 para quien tiene menos de 38 a√±os y 3 meses cotizados?",
        opts: ["65 a√±os", "65 a√±os y 6 meses", "66 a√±os y 10 meses", "67 a√±os"],
        correct: 2,
        explain: "En 2026, la edad ordinaria de jubilaci√≥n es de 66 a√±os y 10 meses para quienes no alcanzan los 38 a√±os y 3 meses cotizados. Quienes s√≠ los acrediten pueden jubilarse a los 65 a√±os. En 2027 la edad general subir√° a 67."
      },
      {
        q: "¬øQu√© porcentaje de la base reguladora se cobra a partir del 7.¬∫ mes de prestaci√≥n por desempleo?",
        opts: ["70%", "65%", "60%", "50%"],
        correct: 2,
        explain: "La prestaci√≥n por desempleo es del 70% de la base reguladora durante los primeros 180 d√≠as (6 meses) y del 60% a partir del d√≠a 181 (7.¬∫ mes) hasta el fin de la prestaci√≥n."
      },
      {
        q: "¬øHay periodo de carencia para acceder a la IT por accidente de trabajo?",
        opts: ["S√≠, 180 d√≠as cotizados", "S√≠, 30 d√≠as cotizados", "No, no hay periodo de carencia", "Depende del tipo de empresa"],
        correct: 2,
        explain: "Los accidentes de trabajo y enfermedades profesionales no requieren periodo de carencia. La protecci√≥n es inmediata: se percibe prestaci√≥n desde el d√≠a siguiente al accidente."
      },
      {
        q: "¬øCu√°ntos a√±os cotizados se necesitan para cobrar el 100% de la pensi√≥n de jubilaci√≥n en 2026?",
        opts: ["15 a√±os", "25 a√±os", "36 a√±os y 6 meses", "37 a√±os y 3 meses"],
        correct: 2,
        explain: "En 2026, se necesitan 36 a√±os y 6 meses cotizados para tener derecho al 100% de la base reguladora. Con solo 15 a√±os se accede al 50%. A partir de 2027 el requisito sube a 37 a√±os."
      },
    ]
  },
  {
    id: 3, name: "Derechos y Obligaciones",
    lessons: [
      {
        tag: "Lecci√≥n 1 ‚Äî Obligaciones de empresa",
        title: "Lo que debe hacer el empleador",
        body: `
          <p>Las empresas tienen una serie de <strong>obligaciones legales</strong> frente a la Seguridad Social que no pueden eludir:</p>
          <div class="info-box">üìå <strong>Inscripci√≥n:</strong> antes de contratar a alguien, la empresa debe inscribirse en la Seguridad Social y obtener un C√≥digo de Cuenta de Cotizaci√≥n (CCC).</div>
          <div class="info-box green">‚è±Ô∏è <strong>Afiliaci√≥n y alta:</strong> debe tramitar el alta del trabajador antes o el mismo d√≠a del inicio de la actividad.</div>
          <div class="info-box yellow">üí≥ <strong>Cotizaci√≥n:</strong> ingresar mensualmente las cuotas (tanto la parte del trabajador como la de la empresa) antes del √∫ltimo d√≠a de cada mes.</div>
          <p>El incumplimiento puede suponer <strong>recargos, sanciones y responsabilidad directa</strong> en el pago de prestaciones al trabajador.</p>
        `
      },
      {
        tag: "Lecci√≥n 2 ‚Äî Derechos del trabajador",
        title: "¬øQu√© tienes derecho a recibir?",
        body: `
          <p>Todo trabajador afiliado y en alta tiene derechos reconocidos por la Seguridad Social:</p>
          <div class="info-box green">‚úÖ Asistencia sanitaria p√∫blica<br>‚úÖ Prestaciones econ√≥micas (IT, paro, jubilaci√≥n‚Ä¶)<br>‚úÖ Protecci√≥n frente a accidentes de trabajo y enfermedades profesionales<br>‚úÖ Acceso al historial de vida laboral en cualquier momento</div>
          <p>Puedes consultar tu vida laboral, tus bases de cotizaci√≥n y los d√≠as cotizados a trav√©s de la <strong>Sede Electr√≥nica de la Seguridad Social</strong> (sede.seg-social.gob.es) con certificado digital, Cl@ve o SMS.</p>
          <div class="info-box">üì± La app <strong>Import@ss</strong> es la herramienta oficial para consultar tu vida laboral desde el m√≥vil.</div>
        `
      },
      {
        tag: "Lecci√≥n 3 ‚Äî Infracciones y sanciones",
        title: "Qu√© pasa si no se cumplen las normas",
        body: `
          <p>La Ley de Infracciones y Sanciones en el Orden Social (LISOS) clasifica las infracciones en <strong>leves, graves y muy graves</strong>:</p>
          <div class="info-box">üü° <strong>Leve:</strong> no conservar documentaci√≥n, peque√±os retrasos. Multa de 60 a 625‚Ç¨.</div>
          <div class="info-box yellow">üü† <strong>Grave:</strong> no dar de alta a trabajadores, cotizar por debajo de lo real. Multa de 626 a 6.250‚Ç¨.</div>
          <div class="info-box" style="border-color: var(--red)">üî¥ <strong>Muy grave:</strong> obtener prestaciones fraudulentamente, obstaculizar la inspecci√≥n. Multa de 6.251 a 187.515‚Ç¨.</div>
          <p>Adem√°s, si la empresa no cotiz√≥ por un trabajador, la <strong>propia empresa responder√°</strong> directamente de las prestaciones que le correspondan a ese trabajador.</p>
        `
      }
    ],
    quiz: [
      {
        q: "¬øQu√© es el C√≥digo de Cuenta de Cotizaci√≥n (CCC)?",
        opts: ["El n√∫mero de afiliaci√≥n del trabajador", "Un c√≥digo que identifica a la empresa ante la Seguridad Social para cotizar", "El n√∫mero de contrato de trabajo", "El c√≥digo del convenio colectivo aplicable"],
        correct: 1,
        explain: "El CCC es el identificador que la Seguridad Social asigna a la empresa al inscribirse. Es necesario para liquidar cotizaciones y gestionar altas y bajas de los trabajadores."
      },
      {
        q: "¬øD√≥nde puede un trabajador consultar sus d√≠as cotizados y su vida laboral?",
        opts: ["Solo en las oficinas del SEPE", "En la Sede Electr√≥nica de la Seguridad Social o con la app Import@ss", "Solo mediante una carta certificada al INSS", "En la Agencia Tributaria (AEAT)"],
        correct: 1,
        explain: "La Seguridad Social ofrece acceso a la vida laboral online a trav√©s de su Sede Electr√≥nica (con Cl@ve, certificado digital o SMS) y mediante la app oficial Import@ss para m√≥vil."
      },
      {
        q: "Si una empresa no da de alta a un trabajador y este sufre un accidente, ¬øqui√©n responde de las prestaciones?",
        opts: ["El FOGASA", "El propio trabajador", "La empresa empleadora directamente", "Ninguna entidad, ya que el trabajador no estaba dado de alta"],
        correct: 2,
        explain: "La responsabilidad directa recae sobre la empresa infractora. Esto se conoce como 'responsabilidad empresarial directa en prestaciones': el incumplimiento del deber de dar de alta no perjudica al trabajador, sino que se vuelve contra la empresa."
      },
      {
        q: "Seg√∫n la LISOS, ¬øc√≥mo se clasifica no dar de alta a un trabajador en la Seguridad Social?",
        opts: ["Infracci√≥n leve", "Infracci√≥n grave", "Infracci√≥n muy grave", "No es infracci√≥n si el contrato es verbal"],
        correct: 1,
        explain: "No afiliar o no dar de alta a un trabajador es una infracci√≥n grave seg√∫n la LISOS, sancionable con multas de entre 626 y 6.250 euros, adem√°s de la posible responsabilidad directa en prestaciones."
      },
      {
        q: "¬øCu√°ndo debe ingresar la empresa las cuotas de Seguridad Social de sus trabajadores?",
        opts: ["En los primeros 10 d√≠as de cada mes", "Antes del √∫ltimo d√≠a del mes en que se devengan", "Trimestralmente junto con el modelo 303 de IVA", "En los primeros 20 d√≠as del mes siguiente"],
        correct: 1,
        explain: "Las cuotas de Seguridad Social deben liquidarse antes del √∫ltimo d√≠a del mes al que corresponden, mediante el sistema RED o los sistemas habilitados por la TGSS."
      },
      {
        q: "¬øCu√°l de los siguientes es un derecho del trabajador garantizado por la Seguridad Social?",
        opts: ["Elegir libremente su mutua de accidentes", "Cobrar el 100% de su salario en cualquier baja m√©dica", "Acceder a asistencia sanitaria p√∫blica y prestaciones econ√≥micas", "Que la empresa pague √≠ntegramente su cotizaci√≥n"],
        correct: 2,
        explain: "Entre los derechos fundamentales reconocidos por la Seguridad Social est√°n la asistencia sanitaria p√∫blica y el acceso a las prestaciones econ√≥micas (IT, desempleo, jubilaci√≥n‚Ä¶) cuando se cumplen los requisitos."
      }
    ]
  }
];

// =====================
// STATE
// =====================
let currentMode = 'learn';
let currentTopicIdx = 0;
let currentLessonIdx = 0;
let currentQuizIdx = 0;
let quizScore = 0;
let quizAnswered = false;
let currentQuizQuestions = [];
let history = [];

// =====================
// NAVIGATION
// =====================
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  const backBtn = document.getElementById('backBtn');
  backBtn.classList.toggle('visible', id !== 'home');
  history.push(id);
  window.scrollTo({ top: 0, behavior: 'instant' });
  document.documentElement.scrollTop = 0;
  document.body.scrollTop = 0;
}

function goBack() {
  history.pop();
  const prev = history.length ? history[history.length-1] : 'home';
  history.pop();
  showScreen(prev);
}

function setMode(mode) { currentMode = mode; }

function selectTopic(idx) {
  currentTopicIdx = idx;
  if (currentMode === 'learn') {
    currentLessonIdx = 0;
    showLesson();
  } else {
    startQuiz();
  }
}

function startLearnTopic(idx) {
  currentMode = 'learn';
  currentTopicIdx = idx;
  currentLessonIdx = 0;
  history = ['home'];
  showLesson();
}

// =====================
// LESSONS
// =====================
function showLesson() {
  showScreen('lesson-screen');
  const topic = topics[currentTopicIdx];
  const lesson = topic.lessons[currentLessonIdx];
  const total = topic.lessons.length;
  const pct = ((currentLessonIdx + 1) / (total + 1)) * 100;

  document.getElementById('lessonProgressBar').style.width = pct + '%';
  document.getElementById('lessonProgressLabel').textContent = `Lecci√≥n ${currentLessonIdx+1} de ${total}`;

  const isLast = currentLessonIdx === total - 1;
  document.getElementById('lessonCard').innerHTML = `
    <div class="lesson-tag"><span class="dot"></span>${lesson.tag}</div>
    <h2 class="lesson-title">${lesson.title}</h2>
    <div class="lesson-body">${lesson.body}</div>
    <div class="lesson-nav">
      <button class="btn-nav" onclick="prevLesson()" ${currentLessonIdx === 0 ? 'disabled' : ''}>‚Üê Anterior</button>
      <button class="btn-nav next" onclick="${isLast ? 'startQuiz()' : 'nextLesson()'}">${isLast ? '‚úèÔ∏è Ir al Quiz' : 'Siguiente ‚Üí'}</button>
    </div>
  `;
}

function nextLesson() {
  currentLessonIdx++;
  showLesson();
}
function prevLesson() {
  if (currentLessonIdx > 0) { currentLessonIdx--; showLesson(); }
}

// =====================
// QUIZ
// =====================
function startQuiz() {
  currentQuizIdx = 0;
  quizScore = 0;
  currentQuizQuestions = [...topics[currentTopicIdx].quiz];
  showQuizQuestion();
}

function showQuizQuestion() {
  showScreen('quiz-screen');
  const q = currentQuizQuestions[currentQuizIdx];
  const total = currentQuizQuestions.length;
  const pct = (currentQuizIdx / total) * 100;

  document.getElementById('quizProgressBar').style.width = pct + '%';
  document.getElementById('quizProgressLabel').textContent = `Pregunta ${currentQuizIdx+1} de ${total}`;
  document.getElementById('quizNumber').textContent = `${topics[currentTopicIdx].name}`;
  document.getElementById('quizScoreBadge').textContent = `‚úì ${quizScore} correcta${quizScore !== 1 ? 's' : ''}`;
  document.getElementById('quizQuestion').textContent = q.q;
  document.getElementById('feedbackBox').style.display = 'none';
  document.getElementById('quizNext').style.display = 'none';

  const letters = ['A','B','C','D'];
  document.getElementById('quizOptions').innerHTML = q.opts.map((opt, i) => `
    <button class="option-btn" onclick="answerQuestion(${i})">
      <span class="opt-letter">${letters[i]}</span>
      ${opt}
    </button>
  `).join('');
}

function answerQuestion(idx) {
  const q = currentQuizQuestions[currentQuizIdx];
  const btns = document.querySelectorAll('.option-btn');
  btns.forEach(b => b.disabled = true);

  const isCorrect = idx === q.correct;
  if (isCorrect) quizScore++;

  btns[idx].classList.add(isCorrect ? 'correct' : 'wrong');
  if (!isCorrect) btns[q.correct].classList.add('correct');

  const fb = document.getElementById('feedbackBox');
  fb.className = 'feedback-box ' + (isCorrect ? 'correct' : 'wrong');
  fb.innerHTML = `<span class="feedback-icon">${isCorrect ? '‚úÖ' : '‚ùå'}</span> <strong>${isCorrect ? '¬°Correcto!' : 'Incorrecto.'}</strong> ${q.explain}`;
  fb.style.display = 'block';

  document.getElementById('quizScoreBadge').textContent = `‚úì ${quizScore} correcta${quizScore !== 1 ? 's' : ''}`;

  const nextBtn = document.getElementById('quizNext');
  const isLast = currentQuizIdx === currentQuizQuestions.length - 1;
  nextBtn.textContent = isLast ? 'üìä Ver resultados' : 'Siguiente pregunta ‚Üí';
  nextBtn.style.display = 'block';
}

function nextQuestion() {
  currentQuizIdx++;
  if (currentQuizIdx >= currentQuizQuestions.length) {
    showResults();
  } else {
    showQuizQuestion();
  }
}

// =====================
// RESULTS
// =====================
function showResults() {
  showScreen('results-screen');
  const total = currentQuizQuestions.length;
  const pct = Math.round((quizScore / total) * 100);
  const circumference = 2 * Math.PI * 65;
  const offset = circumference - (pct / 100) * circumference;

  document.getElementById('resultScore').textContent = `${quizScore}/${total}`;
  document.getElementById('resultRing').style.strokeDashoffset = circumference;
  setTimeout(() => {
    document.getElementById('resultRing').style.strokeDashoffset = offset;
  }, 100);

  let title, sub, color;
  if (pct === 100) {
    title = '¬°Perfecto! üèÜ'; sub = 'Dominas este tema completamente.'; color = 'var(--accent3)';
  } else if (pct >= 66) {
    title = '¬°Muy bien! üëè'; sub = 'Buen dominio del tema. Repasa los fallos.'; color = 'var(--accent)';
  } else if (pct >= 33) {
    title = 'Puedes mejorar üí™'; sub = 'Hay conceptos que reforzar. ¬°Repasa las lecciones!'; color = 'var(--accent2)';
  } else {
    title = 'A repasar üìñ'; sub = 'Te recomendamos volver a las lecciones antes del quiz.'; color = 'var(--red)';
  }

  document.getElementById('resultRing').style.stroke = color;
  document.getElementById('resultTitle').textContent = title;
  document.getElementById('resultSub').textContent = sub;
}

function repeatQuiz() { startQuiz(); }
</script>
</body>
</html>
